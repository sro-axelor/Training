<?xml version="1.0" encoding="UTF-8"?>

<xml-inputs xmlns="http://axelor.com/xml/ns/data-import"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/data-import 
  https://axelor.com/xml/ns/data-import/data-import_5.4.xsd">

<!-- xml configuration files (xml datamapping) -->
<!-- adaptors -->
	<adapter name="LocalDate"
		type="com.axelor.data.adapter.JavaTimeAdapter">
		<option name="type" value="LocalDate" />
		<option name="format" value="dd/MM/yyyy" />
	</adapter>

	 <adapter name="Boolean" type="com.axelor.data.adapter.BooleanAdapter">
     	<option name="falsePattern" value="(0|false|no|f|n)"/>
	 </adapter>

<!-- input and binding part -->
    <input file="customers.xml" root="customer-root">

		<bind node="configs/titles/title"
			type="com.axelor.action.db.Title" search="self.code = :code"
			update="false">
			<bind node="@code" to="code" />
			<bind node="text()" to="name" />
		</bind>
		<!-- <bind node="configs/orders/order" type="com.axelor.action.db.Order" 
			search="self.orderId = :orderId" update="false"> -->
		<!-- <bind node="@orderId" to="orderId" /> -->
		<!-- <bind node="text()" to="orderName" /> -->
		<!-- </bind> -->

		<bind node="customers/customer"
			type="com.axelor.action.db.Customer">
			<bind node="title" to="title" search="self.name = :title" />

<!-- if @code of node title exist and not empty then bind to field notes -->
			<bind node="title/@code" to="notes" alias="title_code"
				if="title_code &amp;&amp; !title_code.empty" />

			<bind node="name[@type='F']" to="firstName" />
			<bind node="name[@type='M']" to="middleName" />
			<bind node="name[@type='L']" to="lastName" />
			<bind node="dateOfBirth" to="dateOfBirth" />
       <!-- <bind node="gender" to="gender"/> -->
			<bind node="email" to="email" />
			<bind node="phone" to="phone" />

<!-- generate email if doesn't exist -->
			<bind to="email"
				eval='"${firstName}.${middleName}.${lastName}@gmail.com".toLowerCase()'
				if="email == null || email.empty" />

<!-- bind multi-value field -->
			<bind node="my/address-list/address" to="addresslist">
				<bind node="line1" to="street" />
				<bind node="line2" to="area" />
				<bind node="city" to="city" />
				<bind node="@zip" to="zip" />
				<bind node="state" to="state" />
				<bind node="country" to="country" />
			</bind>

<!-- bind with many to many field -->
			<bind node="myorder/order-list/orders" to="orderlist">
				<bind node="orderName" to="orderName" />
				<bind node="orderDate" to="orderDate" adapter="LocalDate"/>
				<bind node="deliveryDate" to="deliveryDate" adapter="LocalDate"/>
				<bind node="active" to="active" adapter="Boolean"/>
			</bind>
		</bind>

    </input>

</xml-inputs>